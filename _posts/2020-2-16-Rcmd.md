---
layout: post
title: How to get R and the command line to talk?
Description: Coding Tutorial
---

Although it is important to spend time learning the theory behind the statistical methods we use, I would argue it's even more important to learn practical ways to implement them. In the statistics curriculum at NC State professors always make an effort to incorporate programming of some form into what we are learning; often in the form of simple scripts. I have taken multiple programming courses during my time at NC State and found the most interesting ones were those that blended computer science and statistics into the curriculum. 

The purpose of this post is to demonstrate a simple procedure for using the command line (terminal) to interact with R. I have chosen to explore this topic since it has not been taught in my curriculum. What I have learned began with some experimentation, searching the internet, and eventually stumbling upon an excellent [tutorial](http://swcarpentry.github.io/r-novice-inflammation/05-cmdline/index.html) offered by Software Carpentry.

\* If you are using windows this tutorial may not work for you.

### Let's begin!

First let's define what exactly we want our program to do!

+ Simulate 100 linear regression Coefficients
  - Generate a normally distributed (mean 0, variance 1)data set of size n. 
  - Create a new variable y that is a linear combination of the previously generated data, plus some noise.
  - Fit a linear regression model and save the parameter estimates to a csv file.
+ Plot a histogram showing the empirical distribution of the intercept and slope for our linear regression.
  - Add a line showing the empirical density.

Although we can accomplish this by only using R we will use the command line to specify the sample size we wish to use.


### Command Line Program
Since this is a relatively simple program we will begin by removing any previously saved csv's of coefficients, and then write a simple for loop program.

'''        
rm ~/Documents/sandbox/Coefficients.csv

for i in {1..100}

do Rscript data_generation0.r 100

done

Rscript plots1.r
'''     

Note that in the above code the 100 following data_generation0.r is the sample size to be used in the r script.

### Rscripts

'''      
# Read in user defined sample size
args <- commandArgs(trailingOnly = TRUE)

sampsize <- args[1]

x <- rnorm(n = sampsize, mean = 0, sd = 1)

y <- 5 * x + rnorm(sampsize, mean = 0, sd = .25)

fit <- lm(y~x)

b0 <- fit$coefficients[1]
names(b0) <- NULL
b1 <- fit$coefficients[2]
names(b1) <- NULL

x <- cbind.data.frame(b0,b1)

write.table(x, file = "Coefficients.csv", sep = ",",
            append = TRUE,row.names = FALSE, col.names = FALSE)
'''          

\* Notice how we used the commandArgs() function to tell R to grab the list of arguments following the execution of the Rscript.

'''      
 x <- read.csv("Coefficients.csv", header = FALSE)
 

png(filename = "Intercept.png")
hist(x$V1, freq = FALSE, xlab = 'Beta 0', main = 'Empirical Distribution of Beta 0')
lines(density(x$V1))
dev.off()

png(filename = "Slope.png")
hist(x$V2, freq = FALSE, xlab = 'Beta 1', main = 'Empirical Distribution of Beta 1')
lines(density(x$V2))
dev.off()
'''     

The results that we receive are as expected:
